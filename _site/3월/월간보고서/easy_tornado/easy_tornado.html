<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/style2.css">
<title>easy_tornado</title>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>easy_tornado | RAON Whitehat</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="easy_tornado" />
<meta name="author" content="Core Research Team" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="2020.03.29.일~" />
<meta property="og:description" content="2020.03.29.일~" />
<link rel="canonical" href="http://localhost:4000/3%EC%9B%94/%EC%9B%94%EA%B0%84%EB%B3%B4%EA%B3%A0%EC%84%9C/easy_tornado/easy_tornado.html" />
<meta property="og:url" content="http://localhost:4000/3%EC%9B%94/%EC%9B%94%EA%B0%84%EB%B3%B4%EA%B3%A0%EC%84%9C/easy_tornado/easy_tornado.html" />
<meta property="og:site_name" content="RAON Whitehat" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-28T19:31:01+00:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/3%EC%9B%94/%EC%9B%94%EA%B0%84%EB%B3%B4%EA%B3%A0%EC%84%9C/easy_tornado/easy_tornado.html"},"@type":"BlogPosting","author":{"@type":"Person","name":"Core Research Team"},"url":"http://localhost:4000/3%EC%9B%94/%EC%9B%94%EA%B0%84%EB%B3%B4%EA%B3%A0%EC%84%9C/easy_tornado/easy_tornado.html","headline":"easy_tornado","dateModified":"2020-03-28T19:31:01+00:00","datePublished":"2020-03-28T19:31:01+00:00","description":"2020.03.29.일~","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>
  <body>

    <main class="container">      <section class="about">
        <a href="/"><img src="/assets/upload_image/raon_whitehat.png" alt="RAON Whitehat"></a>
        <h2 id="title">
          <a href="/" style="font-size: 28px">Raon Whitehat</a>
        </h2>
        <p class="tagline" style="font-size: 18px">Core Research Team</p>
        <ul class="social">
            <a href="http://www.raoncorp.com/">
              <li>
                <svg class="bi bi-house-door-fill" width="1.7em" height="1.7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
				  <path d="M6.5 10.995V14.5a.5.5 0 01-.5.5H2a.5.5 0 01-.5-.5v-7a.5.5 0 01.146-.354l6-6a.5.5 0 01.708 0l6 6a.5.5 0 01.146.354v7a.5.5 0 01-.5.5h-4a.5.5 0 01-.5-.5V11c0-.25-.25-.5-.5-.5H7c-.25 0-.5.25-.5.495z"/>
				  <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 01.5-.5h1a.5.5 0 01.5.5z" clip-rule="evenodd"/>
				</svg>
              </li>
            </a>
        </ul><p>&copy;
          2020</p>
      </section><section class="content">
        <div class="post-container">
  <a class="post-link" href="/3%EC%9B%94/%EC%9B%94%EA%B0%84%EB%B3%B4%EA%B3%A0%EC%84%9C/easy_tornado/easy_tornado.html">
    <h2 class="post-title">easy_tornado</h2>
  </a>
  <div class="post-meta">
    <ul class="post-categories"><li>3월</li><li>월간보고서</li><li>easy_tornado</li></ul>
    <div class="post-date"><i class="icon-calendar"></i>Mar 28, 2020</div>
  </div>
  <div class="post">
    <ul>
  <li>2020.03.29.일~</li>
</ul>

<p><img src="/assets/upload_image/Untitled.png" alt="/assets/upload_image/Untitled.png" /></p>

<p><img src="/assets/upload_image/Untitled%201.png" alt="/assets/upload_image/Untitled%201.png" /></p>

<ul>
  <li>문제에 접속하면 3개의 파일이 존재한다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%202.png" alt="/assets/upload_image/Untitled%202.png" /></p>

<ul>
  <li><code class="highlighter-rouge">hint.txt</code>에 들어가보니 <code class="highlighter-rouge">filename</code> 파라미터와 <code class="highlighter-rouge">filehash</code> 파라미터를 전달받는다.</li>
  <li><code class="highlighter-rouge">filehash</code>는 <code class="highlighter-rouge">md5(cookie_secret+md5(filename))</code>으로 이뤄지는 것 같다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%203.png" alt="/assets/upload_image/Untitled%203.png" /></p>

<ul>
  <li>filename에 ../../../../../../를 입력해서 전송해보았다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%204.png" alt="/assets/upload_image/Untitled%204.png" /></p>

<ul>
  <li>Error 페이지가 출력된다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%205.png" alt="/assets/upload_image/Untitled%205.png" /></p>

<ul>
  <li>msg 파라미터를 다른 text로 바꾸면 해당 text가 출력된다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%206.png" alt="/assets/upload_image/Untitled%206.png" /></p>

<ul>
  <li>template injection을 예상하여 ``을 입력해 보았다.</li>
  <li>필터링이 되어있는 듯 하다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%207.png" alt="/assets/upload_image/Untitled%207.png" /></p>

<ul>
  <li><code class="highlighter-rouge">를 입력해 보니 3+4의 값이 출력되었다.</code>안의 식이 계산되어 출력됨을 확인할 수 있다.</li>
</ul>

<p><img src="/assets/upload_image/Untitled%208.png" alt="/assets/upload_image/Untitled%208.png" /></p>

<ul>
  <li><code class="highlighter-rouge">SSTI 취약점</code>이 존재하므로, 해당 취약점을 악용해 내부 파일또는 정보를 획득할 수 있을 것이라고 생각하였다.</li>
</ul>

<h3 id="ssti-취약점이란">SSTI 취약점이란?</h3>

<hr />

<p><strong>Server-Side Template를 사용하는 이유</strong></p>

<ul>
  <li>동적 웹페이지를 통해 한번 가공한 결과를 웹페이지로 유저에게 보여줄 수 있음. 템플릿을 사용하면 간단한 문법으로 쉽게 제작할 수 있고, 유지보수도 편리함</li>
</ul>

<p><strong>종류</strong></p>

<ul>
  <li>Ruby, Java, Twig, Smarty, Freemarker, Jade/Codepen, Velocity, Mako, Jinja2</li>
</ul>

<p><strong>예시</strong></p>

<ul>
  <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server Side Template Injection</a></li>
  <li>`` 을 입력해서 결과 값이 화면에 출력되는지 확인해본다.</li>
</ul>

<p><strong>취약점 발생 원인</strong></p>

<ul>
  <li>Remote Code Excute가 템플릿의 파일위치로 들어가게 된다면, 인젝션이 가능하다. eval 함수와 동일하게 작동되기 때문에, 악의적인 데이터를 주입하여 다양한 영향을 끼칠 수 있다.</li>
</ul>

<h3 id="tornado란">Tornado란?</h3>

<hr />

<ul>
  <li>
    <p>해당 문제의 이름은 Tornado이다. SSTI와 Tornado를 검색해봤다. Tornado는 웹 프레임워크로, 파이썬으로 이벤트를 처리할 때 쓰여진다. 웹소켓 방식에 잘 활용되고, 비동기식 웹페이지를 위한 프레임워크이다.</p>

    <p>from tornado_jinja2 import Jinja2Loader</p>
  </li>
  <li>
    <p>위와 같이 사용할 수 있다.</p>
  </li>
</ul>

<h3 id="tornado-사용법">Tornado 사용법</h3>

<hr />

<ul>
  <li>
    <p>간단한 Tornado 사용법을 알아보았다.</p>

    <p>import tornado.httpserver
  import tornado.ioloop
  import tornado.webclass</p>
  </li>
  <li>
    <p>URL 또는 URL 패턴을 tornado.web.RequestHandler의 서브클래스로 매핑해서 사용한다.</p>
  </li>
</ul>

<p><a href="https://blog.naver.com/mildnightjin/221882536165">https://blog.naver.com/mildnightjin/221882536165</a></p>

<p><img src="/assets/upload_image/Untitled%209.png" alt="/assets/upload_image/Untitled%209.png" /></p>

<h3 id="지한별">지한별</h3>

<ol>
  <li>지한별</li>
  <li>지한별</li>
  <li>지한별</li>
</ol>

<p><code class="highlighter-rouge"><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">hi</span><span class="p">;</span><span class="cp">?&gt;</span></code></p>

<p><img src="/assets/upload_image/image-20200401105439047.png" alt="/assets/upload_image/image-20200401105439047.png" /></p>

<p>위 그림과 같다.</p>


  </div></div>

      </section>
    </main></body>
</html>
